<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Harmonie RAPS benchmark · Harmonie wiki</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit">Harmonie wiki</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Running at ECMWF and local</span><ul><li><a class="tocitem" href="../Harmonie-mSMS/">Running at ECMWF</a></li><li><a class="tocitem" href="../Fast_start_on_cca/">Fast start on cca</a></li><li><a class="tocitem" href="../QuickStartLocal/">Quick start local</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../Installation/">Installation</a></li><li><a class="tocitem" href="../General/">General Software Requirements</a></li><li><a class="tocitem" href="../Build_with_makeup/">Makeup</a></li><li><a class="tocitem" href="../StandaloneOdb/">Stand Alone ODB</a></li><li><a class="tocitem" href="../Redhat7Install/">Redhat7</a></li><li><a class="tocitem" href="../Centos6Install/">Centos6</a></li></ul></li><li><a class="tocitem" href="../TheHarmonieScript/">The Harmonie Script</a></li><li><a class="tocitem" href="../DrHook/">Profiling and Traceback</a></li><li><a class="tocitem" href="../FileFormats/">File Formats</a></li><li><span class="tocitem">Job Scheduling</span><ul><li><a class="tocitem" href="../ECFLOW/">ECFlow</a></li><li><a class="tocitem" href="../scripts/mXCdp/">mXCdp</a></li><li><a class="tocitem" href="../scripts/mSMS/">mSMS</a></li></ul></li><li><span class="tocitem">Testbed and Mitraillette</span><ul><li><a class="tocitem" href="../Evaluation/HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../Evaluation/Mitraillette/">Mitraillette</a></li></ul></li><li><span class="tocitem">Directories  and Binaries</span><ul><li><a class="tocitem" href="../Content/">Directories</a></li><li><a class="tocitem" href="../Binaries/">Binaries</a></li></ul></li><li><span class="tocitem">Configuration</span><ul><li><a class="tocitem" href="../ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../Namelists/">Namelist</a></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li><li><a class="tocitem" href="../ModelDomain/">Model Domain</a></li><li><a class="tocitem" href="../VerticalGrid/">Vertical Grid</a></li><li><a class="tocitem" href="../ClimateSimulation/">Climate Simulation</a></li><li><a class="tocitem" href="../How_to_use_hires_topography/">Hires topography</a></li></ul></li><li><span class="tocitem">ECFlow tasks</span><ul><li><a class="tocitem" href="../ClimateGeneration/">Climate</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../UseofObservation/">Use of Observation</a></li><li><a class="tocitem" href="../ObservationOperators/">Observation operators</a></li><li><a class="tocitem" href="../ObservationHowto/GNSS/">GNSS ZTD observations</a></li><li><a class="tocitem" href="../ObservationHowto/Amv/">Atmospheric Motion Vectors (AMV)</a></li><li><a class="tocitem" href="../RadarData/">Assimilation of Radar Data</a></li><li><input class="collapse-toggle" id="menuitem-11-2-6" type="checkbox"/><label class="tocitem" for="menuitem-11-2-6"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ObservationPreprocessing/ObservationData/">Observation data</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Cope/">Cope</a></li></ul></li></ul></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../BoundaryFilePreparation/">Boundaries</a></li><li><a class="tocitem" href="../Screening/">Screening</a></li><li><a class="tocitem" href="../Analysis/SurfaceAnalysis/">Surface Analysis</a></li><li><a class="tocitem" href="../DigitialFilterInitialization/">DFI</a></li><li><a class="tocitem" href="../Forecast/">Forecast</a></li><li><input class="collapse-toggle" id="menuitem-11-10" type="checkbox"/><label class="tocitem" for="menuitem-11-10"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Obsmon/">Obsmon</a></li><li><a class="tocitem" href="../PostPP/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../PostPP/xtool/">xtool</a></li><li><a class="tocitem" href="../PostPP/gl/Interpolation/">GL interpolation</a></li><li><input class="collapse-toggle" id="menuitem-11-10-5" type="checkbox"/><label class="tocitem" for="menuitem-11-10-5"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Verification/">HARMONIE Verification</a></li><li><a class="tocitem" href="../PostPP/Extract4verification/">-</a></li></ul></li><li><a class="tocitem" href="../PostPP/Fullpos/">Fullpos</a></li><li><a class="tocitem" href="../PostPP/FileConversions/">FileConversion</a></li><li><a class="tocitem" href="../PostPP/gl_grib_api/">gl<em>grib</em>api</a></li></ul></li></ul></li><li><span class="tocitem">Other</span><ul><li><a class="tocitem" href="../Scalability_and_Refactoring/">Scalability and refactoring</a></li><li class="is-active"><a class="tocitem" href>Harmonie RAPS benchmark</a><ul class="internal"><li><a class="tocitem" href="#Background-1"><span>Background</span></a></li><li><a class="tocitem" href="#Getting-the-package-1"><span>Getting the package</span></a></li><li><a class="tocitem" href="#Organization-of-the-package-1"><span>Organization of the package</span></a></li><li><a class="tocitem" href="#Input-files-1"><span>Input files</span></a></li><li><a class="tocitem" href="#Status-1"><span>Status</span></a></li></ul></li><li><a class="tocitem" href="../MFaccess/">Using Météo-France Servers</a></li><li><a class="tocitem" href="../Phasing/">Phasing information</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Other</a></li><li class="is-active"><a href>Harmonie RAPS benchmark</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Harmonie RAPS benchmark</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://hirlam.org/trac//wiki//HarmonieSystemDocumentation/HarmonieBenchMark?action=edit" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Harmonie-RAPS-benchmark-1"><a class="docs-heading-anchor" href="#Harmonie-RAPS-benchmark-1">Harmonie RAPS benchmark</a><a class="docs-heading-anchor-permalink" href="#Harmonie-RAPS-benchmark-1" title="Permalink"></a></h1><h2 id="Background-1"><a class="docs-heading-anchor" href="#Background-1">Background</a><a class="docs-heading-anchor-permalink" href="#Background-1" title="Permalink"></a></h2><p>This page describes the current situation for harmonie as a benchmarking tool. During 2013 several HIRLAM countries will start the procurement for new computers. We hope that by coordinating the efforts we can make a win-win situation for all concerned parties, both vendors and institutes. The benchmarkers on the vendors&#39; side will be able to concentrate their efforts on a single source code base for better productivity and enhanced feedback to the community. Moreover, we believe that the efforts with a common benchmark package will improve the model and might be found useful also in other Harmonie institutes. For the current effort cy38h1 have been chosen as the baseline version. The cycle is currently under preparation and evaluation within the ALADIN/HIRLAM community.</p><h2 id="Getting-the-package-1"><a class="docs-heading-anchor" href="#Getting-the-package-1">Getting the package</a><a class="docs-heading-anchor-permalink" href="#Getting-the-package-1" title="Permalink"></a></h2><p>The package is under preparation and is based on <a href="https://hirlam.org/trac/browser/tags/harmonie-38h1.alpha.2">harmonie-38h1.alpha.2</a> plus [11688] and [11708].</p><p>The second, version is available here: [https://hirlam.org/portal/download/benchmark/src/HMbench<em>cy38a2</em>export.tar.gz].</p><p>Input data and some simple scripts can also be found on hirlam.org [https://hirlam.org/portal/download/benchmark/data/cy38].</p><h2 id="Organization-of-the-package-1"><a class="docs-heading-anchor" href="#Organization-of-the-package-1">Organization of the package</a><a class="docs-heading-anchor-permalink" href="#Organization-of-the-package-1" title="Permalink"></a></h2><h2 id="Input-files-1"><a class="docs-heading-anchor" href="#Input-files-1">Input files</a><a class="docs-heading-anchor-permalink" href="#Input-files-1" title="Permalink"></a></h2><p>Please note that it is crucial to have right namelist settings to enable reproducibility. A set of input files including feasible namelists for different problem sizes is provided to ease up the startup for testing. The problem sizes are sorted according to the international clothing sizes as follows:     </p><pre><code class="language-bash"> XS)
   # 50x50x65, 2.5km resolution
   BDDIR=XS
   MBX_SIZE=20000000
   TSTEP=60

  M)
   #  384x400x65, 2.5km resolution
   BDDIR=M
   MBX_SIZE=200000000
   TSTEP=60

  L)
   #  Nlon,Nlat,Nlev :         750         960          65, 2.5km resolution
   BDDIR=L
   BDINTERVAL=10800.
   TSTEP=60

  XL)
   #  Nlon,Nlat,Nlev :1200        1200          65, 2.5km resolution
   BDDIR=XL
   MBX_SIZE=200000000
   TSTEP=60

  XXL)
   # 1600x1600x65, 2.5km resolution
   BDDIR=XXL
   MBX_SIZE=2000000000
   TSTEP=60</code></pre><p>You will also need the files <a href="https://hirlam.org/portal/download/benchmark/data/cy38/covers.tar">covers.tar</a> and <a href="https://hirlam.org/portal/download/benchmark/data/cy38/rrtm_const.tar">rrtm_const.tar</a>.</p><h2 id="Status-1"><a class="docs-heading-anchor" href="#Status-1">Status</a><a class="docs-heading-anchor-permalink" href="#Status-1" title="Permalink"></a></h2><ul><li>The model is not reproducible for different NPROCX/NRPOCY with the default HARMONIE edmfm scheme. Until solved reproducibility can be achieved by removing from <code>&amp;NAMPARAR</code>:</li></ul><pre><code class="language-bash">   CMF_CLOUD=&#39;STAT&#39;,
   CMF_UPDRAFT=&#39;DUAL&#39;,
   LMIXUV=.TRUE.,</code></pre><pre><code class="language-none">* This makes the the code reproducible on c2a(IBMP7) with the default compilation flags. UPDATE: also with multiple OpenMP threads. 
* Not reproducible on Intel Sandy Bridge (ifort 12.0.5.220 ) with -O2 -fp-model precise but with -O0. OpenMP not reproducible even with -O0.</code></pre><ul><li>OpenMP works technically (on Intel Sandy Bridge, ifort 12.0.5.220) but we don&#39;t get reproducible results when changing the number of openmp threads.</li><li>OpenMP now also tested with ifort 13.0.1 on Sandy Bridge (not using -xAVX flag). Still reproducibility cannot be achieved with any combination of (the many!) compiler flags and environment variable settings tested.<ul><li>If linked without MKL libraries reproducibility is retained.</li></ul></li></ul><ul><li>Gfortran 4.6.3 on an Ubuntu 12.04 workstation, domain XS, gives full reproducibility against variations in NPROCX, NPROCY and OMP<em>NUM</em>THREADS.</li></ul><p><a href="../HarmonieSystemDocumentation.md">Back to the main page of the HARMONIE System Documentation</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Scalability_and_Refactoring/">« Scalability and refactoring</a><a class="docs-footer-nextpage" href="../MFaccess/">Using Météo-France Servers »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 6 September 2021 15:20">Monday 6 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
