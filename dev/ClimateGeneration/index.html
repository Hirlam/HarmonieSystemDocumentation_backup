<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Climate · Harmonie wiki</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit">Harmonie wiki</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Running at ECMWF and local</span><ul><li><a class="tocitem" href="../Harmonie-mSMS/">Running at ECMWF</a></li><li><a class="tocitem" href="../Fast_start_on_cca/">Fast start on cca</a></li><li><a class="tocitem" href="../QuickStartLocal/">Quick start local</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../Installation/">Installation</a></li><li><a class="tocitem" href="../General/">General Software Requirements</a></li><li><a class="tocitem" href="../Build_with_makeup/">Makeup</a></li><li><a class="tocitem" href="../StandaloneOdb/">Stand Alone ODB</a></li><li><a class="tocitem" href="../Redhat7Install/">Redhat7</a></li><li><a class="tocitem" href="../Centos6Install/">Centos6</a></li></ul></li><li><a class="tocitem" href="../TheHarmonieScript/">The Harmonie Script</a></li><li><a class="tocitem" href="../DrHook/">Profiling and Traceback</a></li><li><a class="tocitem" href="../FileFormats/">File Formats</a></li><li><span class="tocitem">Job Scheduling</span><ul><li><a class="tocitem" href="../ECFLOW/">ECFlow</a></li><li><a class="tocitem" href="../scripts/mXCdp/">mXCdp</a></li><li><a class="tocitem" href="../scripts/mSMS/">mSMS</a></li></ul></li><li><span class="tocitem">Testbed and Mitraillette</span><ul><li><a class="tocitem" href="../Evaluation/HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../Evaluation/Mitraillette/">Mitraillette</a></li></ul></li><li><span class="tocitem">Directories  and Binaries</span><ul><li><a class="tocitem" href="../Content/">Directories</a></li><li><a class="tocitem" href="../Binaries/">Binaries</a></li></ul></li><li><span class="tocitem">Configuration</span><ul><li><a class="tocitem" href="../ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../Namelists/">Namelist</a></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li><li><a class="tocitem" href="../ModelDomain/">Model Domain</a></li><li><a class="tocitem" href="../VerticalGrid/">Vertical Grid</a></li><li><a class="tocitem" href="../ClimateSimulation/">Climate Simulation</a></li><li><a class="tocitem" href="../How_to_use_hires_topography/">Hires topography</a></li></ul></li><li><span class="tocitem">ECFlow tasks</span><ul><li class="is-active"><a class="tocitem" href>Climate</a><ul class="internal"><li><a class="tocitem" href="#Generation-of-climate-and-physiography-files-1"><span>Generation of climate and physiography files</span></a></li><li><a class="tocitem" href="#Introduction-1"><span>Introduction</span></a></li><li><a class="tocitem" href="#Input-data-for-climate-generation-1"><span>Input data for climate generation</span></a></li><li><a class="tocitem" href="#Preparation-of-SURFEX-physiography-file-1"><span>Preparation of SURFEX physiography file</span></a></li><li><a class="tocitem" href="#Generation-of-a-non-SURFEX-climate-file-1"><span>Generation of a non SURFEX climate file</span></a></li><li><a class="tocitem" href="#[Back-to-the-main-page-of-the-HARMONIE-System-Documentation](../HarmonieSystemDocumentation.md)-1"><span>Back to the main page of the HARMONIE System Documentation</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../UseofObservation/">Use of Observation</a></li><li><a class="tocitem" href="../ObservationOperators/">Observation operators</a></li><li><a class="tocitem" href="../ObservationHowto/GNSS/">GNSS ZTD observations</a></li><li><a class="tocitem" href="../ObservationHowto/Amv/">Atmospheric Motion Vectors (AMV)</a></li><li><a class="tocitem" href="../RadarData/">Assimilation of Radar Data</a></li><li><input class="collapse-toggle" id="menuitem-11-2-6" type="checkbox"/><label class="tocitem" for="menuitem-11-2-6"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ObservationPreprocessing/ObservationData/">Observation data</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Cope/">Cope</a></li></ul></li></ul></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../BoundaryFilePreparation/">Boundaries</a></li><li><a class="tocitem" href="../Screening/">Screening</a></li><li><a class="tocitem" href="../Analysis/SurfaceAnalysis/">Surface Analysis</a></li><li><a class="tocitem" href="../DigitialFilterInitialization/">DFI</a></li><li><a class="tocitem" href="../Forecast/">Forecast</a></li><li><input class="collapse-toggle" id="menuitem-11-10" type="checkbox"/><label class="tocitem" for="menuitem-11-10"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Obsmon/">Obsmon</a></li><li><a class="tocitem" href="../PostPP/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../PostPP/xtool/">xtool</a></li><li><a class="tocitem" href="../PostPP/gl/Interpolation/">GL interpolation</a></li><li><input class="collapse-toggle" id="menuitem-11-10-5" type="checkbox"/><label class="tocitem" for="menuitem-11-10-5"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Verification/">HARMONIE Verification</a></li><li><a class="tocitem" href="../PostPP/Extract4verification/">-</a></li></ul></li><li><a class="tocitem" href="../PostPP/Fullpos/">Fullpos</a></li><li><a class="tocitem" href="../PostPP/FileConversions/">FileConversion</a></li><li><a class="tocitem" href="../PostPP/gl_grib_api/">gl<em>grib</em>api</a></li></ul></li></ul></li><li><span class="tocitem">Other</span><ul><li><a class="tocitem" href="../Scalability_and_Refactoring/">Scalability and refactoring</a></li><li><a class="tocitem" href="../HarmonieBenchMark/">Harmonie RAPS benchmark</a></li><li><a class="tocitem" href="../MFaccess/">Using Météo-France Servers</a></li><li><a class="tocitem" href="../Phasing/">Phasing information</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ECFlow tasks</a></li><li class="is-active"><a href>Climate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Climate</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://hirlam.org/trac//wiki//HarmonieSystemDocumentation/ClimateGeneration?action=edit" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Generation-of-climate-and-physiography-files-1"><a class="docs-heading-anchor" href="#Generation-of-climate-and-physiography-files-1">Generation of climate and physiography files</a><a class="docs-heading-anchor-permalink" href="#Generation-of-climate-and-physiography-files-1" title="Permalink"></a></h2><h2 id="Introduction-1"><a class="docs-heading-anchor" href="#Introduction-1">Introduction</a><a class="docs-heading-anchor-permalink" href="#Introduction-1" title="Permalink"></a></h2><p>The generation of climate files includes two parts. The first part is the generation of climate files for the atmospheric model, the so called  <a href="http://www.cnrm.meteo.fr/gmapdoc/spip.php?page=recherche&amp;recherche=e923">e923</a> configuration. The second part is the generation of the physiography information for  <a href="http://www.cnrm-game-meteo.fr/surfex/">SURFEX</a>. In the following we describe how it is implemented in HARMONIE.</p><h2 id="Input-data-for-climate-generation-1"><a class="docs-heading-anchor" href="#Input-data-for-climate-generation-1">Input data for climate generation</a><a class="docs-heading-anchor-permalink" href="#Input-data-for-climate-generation-1" title="Permalink"></a></h2><p>The location of your input data for the climate generation is defined by the <strong>HM_CLDATA</strong> environment variable defined in the <a href="https://hirlam.org/trac/browser/Harmonie/config-sh/config.ecgb-cca?rev=harmonie-43h2.beta.1">config.yourhost</a> file. At ECMWF the climate data is stored on cca here: <code>cca:/project/hirlam/harmonie/climate_in_order</code></p><p>Information on what data to download is available here: [wiki:HarmonieSystemDocumentation#Downloadinputdata]. The input data contains physiography data, topography information and climatological values determined from a one year ARPEGE assimilation experiment with a resolution of T79. </p><p>In the current version the option to use pre-generated climate files has been introduced to saver time for quick experiments. To use pre-generated domains you need to set USE<em>REF</em>CLIMDIR=yes in Env<em>system. The regenerated domains location is defined in config</em>exp.h and in ECMWF are located in REF<em>CLIMDIR=ec:/hlam/harmonie</em>climdir/release-43h2.1.rc1/<span>$DOMAIN/$</span>ECOCLIMAP_VERSION.</p><h2 id="Preparation-of-SURFEX-physiography-file-1"><a class="docs-heading-anchor" href="#Preparation-of-SURFEX-physiography-file-1">Preparation of SURFEX physiography file</a><a class="docs-heading-anchor-permalink" href="#Preparation-of-SURFEX-physiography-file-1" title="Permalink"></a></h2><p>SURFEX needs information about the distribution of different available tiles like nature, sea, water and town. The nature tile also needs information about type of vegetation and soiltypes. The main input sources for this are found at <a href="http://www.cnrm-game-meteo.fr/surfex/spip.php?rubrique14">SURFEX physiographic maps</a>.</p><p>The data base for SURFEX-file preparation is located under HM_CLDATA/PGD</p><ul><li>ecoclimats_v2.* : Landtypes</li><li>gtopo30.* : Topography</li><li>sand_fao.* : Soil type distribution</li><li>clay_fao.* : Soil type distribution</li></ul><p>The generation of SURFEX physiography file (<strong>PGD.lfi</strong>) is done in <a href="https://hirlam.org/trac/browser/Harmonie/scr/Prepare_pgd">Prepare_pgd</a>. The script creates the namelist OPTIONS.nam based on the <em>DOMAIN</em> settings in <a href="https://hirlam.org/trac/browser/Harmonie/scr/Harmonie_domains.pm">Harmonie_domains.pm</a>. Note that the SURFEX domain is only created over the C+I area. In the namelist we set which scheme that should be activated for each tile.</p><p>| ||||| Tile |  | –- | –- | –- | –- | –- | –- |  |= PHYSICS =|= Nature =|= Sea =|= Water =|= Town =|  |AROME  |ISBA  |SEAFLX|WATFLX |TEB         |  |ALARO  |ISBA  |SEAFLX|WATFLX |Town as rock|</p><p>The program PGD produces one SURFEX physiography file (<strong>PGD.lfi</strong>), which is stored in <em>CLIMDIR</em> directory.</p><p>To make sure we have the same topography input for the atmospheric part we call Prepare_pgd two times. One time to produce a PGD.lfi for SURFEX and a second time to produce a PGD.fa file that can be used as input for the climate generation described below. Note that for the atmosphere the topography will be spectrally filtered and the resulting topography will be imposed on SURFEX again.</p><h2 id="Generation-of-a-non-SURFEX-climate-file-1"><a class="docs-heading-anchor" href="#Generation-of-a-non-SURFEX-climate-file-1">Generation of a non SURFEX climate file</a><a class="docs-heading-anchor-permalink" href="#Generation-of-a-non-SURFEX-climate-file-1" title="Permalink"></a></h2><p><a href="https://hirlam.org/trac/browser/Harmonie/scr/Climate">Climate</a> is a script, which prepares climate file(s) for  prefered forecast range. Climate files are produced for past, present and following month. The outline of <strong>Climate</strong> is as follows:</p><ul><li>Check if climate files already exists.</li><li>Creation of namelists. The definition of domain and truncation values is taken from <a href="https://hirlam.org/trac/browser/Harmonie/scr/Harmonie_domains.pm">Harmonie_domains.pm</a>.</li><li>Part 0: Read the PGD.fa file generated by SURFEX and write it to Neworog</li><li>Part 1: Filter  <strong>Neworog</strong> to target grid with spectral smoothing to remove 2dx waves.</li><li>Part 2: generation of surface, soil and vegetation variables, without annual variation.</li><li>Part 3: creation of monthly climatological values and  modification of albedo and emissivity according to the climatology of sea-ice limit.</li><li>Part 4: definition and modification of the vegetation and surface characteristics</li><li>Part 5: modification of fields created by step 2 and 4 over land from high resolution datasets (for each month)</li><li>Part 6: modification of climatological values</li></ul><p>The result is climate files for the previous, current and next month. The files are named after their month like <strong>m01</strong>, <strong>m02</strong> - <strong>m12</strong> and stored in <em>CLIMDIR</em>.</p><p>Further reference <a href="http://www.cnrm.meteo.fr/gmapdoc/IMG/ps/e923_users.ps">e923</a></p><h2 id="[Back-to-the-main-page-of-the-HARMONIE-System-Documentation](../HarmonieSystemDocumentation.md)-1"><a class="docs-heading-anchor" href="#[Back-to-the-main-page-of-the-HARMONIE-System-Documentation](../HarmonieSystemDocumentation.md)-1"><a href="../HarmonieSystemDocumentation.md">Back to the main page of the HARMONIE System Documentation</a></a><a class="docs-heading-anchor-permalink" href="#[Back-to-the-main-page-of-the-HARMONIE-System-Documentation](../HarmonieSystemDocumentation.md)-1" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../How_to_use_hires_topography/">« Hires topography</a><a class="docs-footer-nextpage" href="../UseofObservation/">Use of Observation »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 March 2021 17:28">Tuesday 30 March 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
