<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Domain · Harmonie wiki</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Harmonie wiki logo"/></a><div class="docs-package-name"><span class="docs-autofit">Harmonie wiki</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Running at ECMWF and local</span><ul><li><a class="tocitem" href="../Harmonie-mSMS/">Running at ECMWF</a></li><li><a class="tocitem" href="../Fast_start_on_cca/">Fast start on cca</a></li><li><a class="tocitem" href="../QuickStartLocal/">Quick start local</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../Installation/">Installation</a></li><li><a class="tocitem" href="../General/">General Software Requirements</a></li><li><a class="tocitem" href="../Build_with_makeup/">Makeup</a></li><li><a class="tocitem" href="../StandaloneOdb/">Stand Alone ODB</a></li><li><a class="tocitem" href="../Redhat7Install/">Redhat7</a></li><li><a class="tocitem" href="../Centos6Install/">Centos6</a></li></ul></li><li><a class="tocitem" href="../TheHarmonieScript/">The Harmonie Script</a></li><li><a class="tocitem" href="../DrHook/">Profiling and Traceback</a></li><li><a class="tocitem" href="../FileFormats/">File Formats</a></li><li><span class="tocitem">Job Scheduling</span><ul><li><a class="tocitem" href="../ECFLOW/">ECFlow</a></li><li><a class="tocitem" href="../scripts/mXCdp/">mXCdp</a></li><li><a class="tocitem" href="../scripts/mSMS/">mSMS</a></li></ul></li><li><span class="tocitem">Testbed and Mitraillette</span><ul><li><a class="tocitem" href="../Evaluation/HarmonieTestbed/">Testbed</a></li><li><a class="tocitem" href="../Evaluation/Mitraillette/">Mitraillette</a></li></ul></li><li><span class="tocitem">Directories  and Binaries</span><ul><li><a class="tocitem" href="../Content/">Directories</a></li><li><a class="tocitem" href="../Binaries/">Binaries</a></li></ul></li><li><span class="tocitem">Configuration</span><ul><li><a class="tocitem" href="../ConfigureYourExperiment/">Experiment</a></li><li><a class="tocitem" href="../PlatformConfiguration/">Platform</a></li><li><a class="tocitem" href="../Namelists/">Namelist</a></li><li><a class="tocitem" href="../UpdateNamelists/">Update Namelist</a></li><li class="is-active"><a class="tocitem" href>Model Domain</a><ul class="internal"><li><a class="tocitem" href="#Model-Domain-1"><span>Model Domain</span></a></li><li><a class="tocitem" href="#Introduction-1"><span>Introduction</span></a></li><li><a class="tocitem" href="#Model-domain-settings-1"><span>Model domain settings</span></a></li><li><a class="tocitem" href="#Domain-creation-tool-1"><span>Domain creation tool</span></a></li><li><a class="tocitem" href="#Creating-a-new-domain-1"><span>Creating a new domain</span></a></li><li><a class="tocitem" href="#Create-a-test-domain-with-gl-1"><span>Create a test domain with gl</span></a></li></ul></li><li><a class="tocitem" href="../VerticalGrid/">Vertical Grid</a></li><li><a class="tocitem" href="../ClimateSimulation/">Climate Simulation</a></li><li><a class="tocitem" href="../How_to_use_hires_topography/">Hires topography</a></li></ul></li><li><span class="tocitem">ECFlow tasks</span><ul><li><a class="tocitem" href="../ClimateGeneration/">Climate</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">Observations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../UseofObservation/">Use of Observation</a></li><li><a class="tocitem" href="../ObservationOperators/">Observation operators</a></li><li><a class="tocitem" href="../ObservationHowto/GNSS/">GNSS ZTD observations</a></li><li><a class="tocitem" href="../ObservationHowto/Amv/">Atmospheric Motion Vectors (AMV)</a></li><li><a class="tocitem" href="../RadarData/">Assimilation of Radar Data</a></li><li><input class="collapse-toggle" id="menuitem-11-2-6" type="checkbox"/><label class="tocitem" for="menuitem-11-2-6"><span class="docs-label">Preprocessing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ObservationPreprocessing/ObservationData/">Observation data</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Cope/">Cope</a></li></ul></li></ul></li><li><a class="tocitem" href="../ObservationPreprocessing/Bator/">Bator</a></li><li><a class="tocitem" href="../ObservationPreprocessing/Oulan/">Oulan</a></li><li><a class="tocitem" href="../BoundaryFilePreparation/">Boundaries</a></li><li><a class="tocitem" href="../Screening/">Screening</a></li><li><a class="tocitem" href="../Analysis/SurfaceAnalysis/">Surface Analysis</a></li><li><a class="tocitem" href="../DigitialFilterInitialization/">DFI</a></li><li><a class="tocitem" href="../Forecast/">Forecast</a></li><li><input class="collapse-toggle" id="menuitem-11-10" type="checkbox"/><label class="tocitem" for="menuitem-11-10"><span class="docs-label">Post Processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Obsmon/">Obsmon</a></li><li><a class="tocitem" href="../PostPP/Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../PostPP/xtool/">xtool</a></li><li><a class="tocitem" href="../PostPP/gl/Interpolation/">GL interpolation</a></li><li><input class="collapse-toggle" id="menuitem-11-10-5" type="checkbox"/><label class="tocitem" for="menuitem-11-10-5"><span class="docs-label">Verification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PostPP/Verification/">HARMONIE Verification</a></li><li><a class="tocitem" href="../PostPP/Extract4verification/">-</a></li></ul></li><li><a class="tocitem" href="../PostPP/Fullpos/">Fullpos</a></li><li><a class="tocitem" href="../PostPP/FileConversions/">FileConversion</a></li><li><a class="tocitem" href="../PostPP/gl_grib_api/">gl<em>grib</em>api</a></li></ul></li></ul></li><li><span class="tocitem">Other</span><ul><li><a class="tocitem" href="../Scalability_and_Refactoring/">Scalability and refactoring</a></li><li><a class="tocitem" href="../HarmonieBenchMark/">Harmonie RAPS benchmark</a></li><li><a class="tocitem" href="../MFaccess/">Using Météo-France Servers</a></li><li><a class="tocitem" href="../Phasing/">Phasing information</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Configuration</a></li><li class="is-active"><a href>Model Domain</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Domain</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://hirlam.org/trac//wiki//HarmonieSystemDocumentation/ModelDomain?action=edit" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Model-Domain-1"><a class="docs-heading-anchor" href="#Model-Domain-1">Model Domain</a><a class="docs-heading-anchor-permalink" href="#Model-Domain-1" title="Permalink"></a></h2><h2 id="Introduction-1"><a class="docs-heading-anchor" href="#Introduction-1">Introduction</a><a class="docs-heading-anchor-permalink" href="#Introduction-1" title="Permalink"></a></h2><p>There are four projections available in HARMONIE, polar stereographic, lambert, mercator and rotated mercator. The model itself chooses the best (least distortion) projection among the first three given your domain specifications. The rotated mercator projection is selected through the variable <em>LROTMER</em>. Note that the polar stereographic project is defined at 90^o^N(S) whereas in GRIB1 it is defined at 60^o^ N(S).</p><p>Polar stereographic, Lambert and Mercator projectionRotated mercator projection</p><h2 id="Model-domain-settings-1"><a class="docs-heading-anchor" href="#Model-domain-settings-1">Model domain settings</a><a class="docs-heading-anchor-permalink" href="#Model-domain-settings-1" title="Permalink"></a></h2><p>For each domain we set variables related to the geometry and the resolution like:</p><p>HARMONIE model domains are defined in settings in <a href="https://hirlam.org/trac/browser/Harmonie/scr/Harmonie_domains.pm">Harmonie_domains.pm</a>. The following variables related to the geometry and the resolution are required:</p><ul><li><em>TSTEP</em> is model timestep in seconds</li><li><em>NLON</em> is number of points in x-direction.</li><li><em>NLAT</em> is number of points in y-direction.</li><li><em>LONC</em> is the longitude of domain centre in degrees.</li><li><em>LATC</em> is the latitude of domain center in degrees.</li><li><em>LON0</em> is the reference longitude of the projection in degrees.</li><li><em>LAT0</em> is the reference latitude of the projection in degrees. __If <em>LAT0</em> is set to 90, the projection is <strong>polar stereographic</strong>. If <em>LAT0</em> &lt; 90, the projection is <strong>lambert</strong> unless LMRT=.TRUE..___  </li><li><em>GSIZE</em> is grid size in meters in both x- and y-direction.</li><li><em>EZONE</em> is number of points over extension zone in both x- and y-direction. Default value 11. </li><li><em>LMRT</em> switch for rotated Mercator projection. If LMRT=.TRUE. LAT0 should be zero.</li></ul><p><em>NLON</em> and <em>NLAT</em> should satisfy the equation 5^b^ * 3^d^ * 2^e^, where a-e are integers &gt;= 0.</p><ul><li>~~<em>BDNLON</em> is number of points in x-direction for intermediate climate file. <em>BDNLON</em> &gt; <em>NLON</em>.~~</li><li>~~<em>BDNLAT</em> is number of points in y-direction for intermediate climate file. <em>BDNLAT</em> &gt; <em>NLAT</em>.~~</li></ul><p>The default area is the Denmark domain (DKCOECP). The following values for C+I zone and truncation are calculated in <a href="https://hirlam.org/trac/browser/Harmonie/scr/Harmonie_domains.pm">Harmonie_domains.pm</a> from the values above. </p><ul><li><em>NDLUXG</em> is number of points in x-direction without extension (E) zone.</li><li><em>NDGUXG</em> is number of points in y-direction without extension (E) zone.</li><li><em>NMSMAX_LINE</em> is truncation order in longitude. By default (<em>NLON</em>-2)/2. </li><li><em>NSMAX_LINE</em> is truncation order in latitude. By default (<em>NLAT</em>-2)/2. </li><li><em>NMSMAX_QUAD</em> is truncation order in longitude. By default (<em>NLON</em>-2)/3. It is used to create filtered orography with lower resolution.</li><li><em>NSMAX_QUAD</em> is truncation order in latitude. By default (<em>NLAT</em>-2)/3. It is used to create filtered orography with lower resolution.</li></ul><p>~~Note that to run with LSPSMORO=yes you have to use a linear grid. I.e. NLON/NLAT must satisfy~~</p><h2 id="Domain-creation-tool-1"><a class="docs-heading-anchor" href="#Domain-creation-tool-1">Domain creation tool</a><a class="docs-heading-anchor-permalink" href="#Domain-creation-tool-1" title="Permalink"></a></h2><p>To help with the design of a new domain, there is an <a href="https://www.hirlam.org/nwptools/domain.html">interactive tool</a> that lets you experiment with the grid parameters described above, and visualize the resulting domain immediately on a map, see figure below.</p><p>At present, it only works for Lambert and polar stereographic projection, not rotated mercator.</p><h2 id="Creating-a-new-domain-1"><a class="docs-heading-anchor" href="#Creating-a-new-domain-1">Creating a new domain</a><a class="docs-heading-anchor-permalink" href="#Creating-a-new-domain-1" title="Permalink"></a></h2><p>If you are happy with your new domain created with the help of the domain creation tool you can add it to <a href="https://hirlam.org/trac/browser/Harmonie/scr/Harmonie_domains.pm">Harmonie_domains.pm</a> for your experiment, my_exp (assuming you have set up the experiment):</p><pre><code class="language-bash">cd $HOME/hm_home/my_exp
PATH_TO_HARMONIE/config-sh/Harmonie co scr/Harmonie_domains.pm
#
# add domain information for new domain called MYNEWDOM in this file
#
vi scr/Harmonie_domains.pm
#
# set DOMAIN=MYNEWDOM in the experiment config file
#
vi ecf/config_exp.h </code></pre><p>You can now start a new experiment with a newly defined domain called MYNEWDOM.</p><h2 id="Create-a-test-domain-with-gl-1"><a class="docs-heading-anchor" href="#Create-a-test-domain-with-gl-1">Create a test domain with gl</a><a class="docs-heading-anchor-permalink" href="#Create-a-test-domain-with-gl-1" title="Permalink"></a></h2><p>Before you go through the full climate generation process you can generate a test domain using gl. Define your domain in the namelist like:</p><pre><code class="language-bash">&amp;NAMINTERP
OUTGEO%NLON = 300 ,
OUTGEO%NLAT = 300,
OUTGEO%PROJECTION = 3,
OUTGEO%WEST = 17.0,
OUTGEO%SOUTH = 58.0,
OUTGEO%DLON = 2500.0
OUTGEO%DLAT = 2500.0
OUTGEO%PROJLAT = 60.0
OUTGEO%PROJLAT2 = 60.0
OUTGEO%PROJLON = 0.0,
/</code></pre><p>Running gl using this namelist by</p><pre><code class="language-bash">gl -n namelist_file</code></pre><p>will create an GRIB file with a constant orography which you can use for plotting.  <a href="../HarmonieSystemDocumentation.md">Back to the main page of the HARMONIE System Documentation</a> ––</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../UpdateNamelists/">« Update Namelist</a><a class="docs-footer-nextpage" href="../VerticalGrid/">Vertical Grid »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 March 2021 17:19">Tuesday 30 March 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
